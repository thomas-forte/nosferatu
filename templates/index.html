{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block page %}
  <div class="py-5 row">
    {% for pin in pins %}
      <div class="col-6">
        <button id="{{ pin.key }}-button" class="btn btn-primary btn-block" type="button">{{ pin.name }}</button>
      </div>
    {% endfor %}
  </div>

  <div class="py-5 row">
    <div id="alerts" class="col"></div>
  </div>
{% endblock %}

{% block scripts %}  
  <script type="text/javascript">
    $(function() { 
      {% for pin in pins %}
        $('#{{ pin.key }}-button').click(function(e) {
          e.preventDefault();
          $.get( "/gpio/{{ pin.pin }}", function() {
            $("#alerts").append("<div class='alert alert-success alert-dismissable'><button type='button' class='close' data-dismiss='alert'><span aria-hidden='true'>&times;</span></button>{{ pin.name }} cycled sucessfully!</div>");
            return true;
          }).fail(function() {
            $("#alerts").append("<div class='alert alert-danger alert-dismissable'><button type='button' class='close' data-dismiss='alert'><span aria-hidden='true'>&times;</span></button>{{ pin.name }} cycle failed!</div>");
            return false;
          });
        });
      {% endfor %}
    });
  </script>
{% endblock %}
